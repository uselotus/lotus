- name: Set up pnpm
  uses: pnpm/action-setup@v2.0.1
  with:
    version: 6
    # Only install what we need to run the client in-action and tests against it
    # format:    `--filter <packagename>...`
    run_install: |
      - args: [--filter myclient... --filter cypress-tests...]

- name: Run Cypress tests
  uses: cypress-io/github-action@v2
  with:
    # we have already installed all dependencies above
    install: false
    command: pnpm --dir cypress/ cypress:ci
    start: pnpm --dir myclient/ dev
    wait-on: 'https://localhost:8000'
